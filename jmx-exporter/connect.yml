startDelaySeconds: 0
lowercaseOutputName: true
lowercaseOutputLabelNames: true

rules:
  # Worker metrics
  - pattern: 'kafka\.connect<type=connect-worker-metrics><>connector-count'
    name: connect_worker_connector_count
    type: GAUGE

  - pattern: 'kafka\.connect<type=connect-worker-metrics><>task-count'
    name: connect_worker_task_count
    type: GAUGE

  - pattern: 'kafka\.connect<type=connect-worker-metrics><>connector-startup-attempts-total'
    name: connect_worker_connector_startup_attempts_total
    type: COUNTER

  # Connector metrics
  - pattern: 'kafka\.connect<type=connector-metrics, connector=([^>]+)><>status'
    name: connect_connector_status
    labels:
      connector: "$1"
    type: GAUGE

  # Sink task metrics
  - pattern: 'kafka\.connect<type=sink-task-metrics, connector=([^,]+), task=([^>]+)><>sink-record-read-total'
    name: connect_sink_task_record_read_total
    labels:
      connector: "$1"
      task: "$2"
    type: COUNTER

  - pattern: 'kafka\.connect<type=sink-task-metrics, connector=([^,]+), task=([^>]+)><>sink-record-send-total'
    name: connect_sink_task_record_send_total
    labels:
      connector: "$1"
      task: "$2"
    type: COUNTER

  - pattern: 'kafka\.connect<type=sink-task-metrics, connector=([^,]+), task=([^>]+)><>put-batch-avg-time-ms'
    name: connect_sink_task_put_batch_avg_time_ms
    labels:
      connector: "$1"
      task: "$2"
    type: GAUGE

  # Connector task metrics
  - pattern: 'kafka\.connect<type=connector-task-metrics, connector=([^,]+), task=([^>]+)><>status'
    name: connect_task_status
    labels:
      connector: "$1"
      task: "$2"
    type: GAUGE

  - pattern: 'kafka\.connect<type=connector-task-metrics, connector=([^,]+), task=([^>]+)><>batch-size-avg'
    name: connect_task_batch_size_avg
    labels:
      connector: "$1"
      task: "$2"
    type: GAUGE

  - pattern: 'kafka\.connect<type=connector-task-metrics, connector=([^,]+), task=([^>]+)><>running-ratio'
    name: connect_task_running_ratio
    labels:
      connector: "$1"
      task: "$2"
    type: GAUGE

  # Task error metrics
  - pattern: 'kafka\.connect<type=task-error-metrics, connector=([^,]+), task=([^>]+)><>total-record-failures'
    name: connect_task_record_failures_total
    labels:
      connector: "$1"
      task: "$2"
    type: COUNTER

  - pattern: 'kafka\.connect<type=task-error-metrics, connector=([^,]+), task=([^>]+)><>total-errors-logged'
    name: connect_task_errors_logged_total
    labels:
      connector: "$1"
      task: "$2"
    type: COUNTER
